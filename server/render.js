import React from "react";import path from "path";import fs from "fs";import SSR from '../dist/node/main';const ssr = new SSR();const prepHTML = ( data, { htmlStream, styleTags, scriptTags, body } ) => {	data = data.replace( '<html', `<html ${ htmlStream }` );	data = data.replace( '</head>', `${ styleTags }</head>` );	data = data.replace( '<div id=root></div>', `<div id="root">${ body }</div>` );	data = data.replace( '</body>', `${ scriptTags }</body>` );	return data;}const render = async ctx => {	if ( global.routers.includes( ctx.path ) ) {		const filePath = path.resolve( __dirname, '../dist/index.html' );		ctx.type = 'html';		ctx.body = await new Promise( ( resolve, reject ) => {			fs.readFile( filePath, 'utf-8', ( err, htmlData ) => {				if ( err ) {					console.error( '读取文件错误!', err );					resolve( '读取文件错误!' )					return false;				}				const context = {};				const rendered = ssr.renderWithStream( ctx.url, {}, context );				const html = prepHTML( htmlData, rendered )				resolve( html )			} )		} )	} else {		ctx.code = 404;	}}export default render;