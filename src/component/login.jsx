import React, { Component } from "react";import { Avatar, Button, Modal, Input, Space } from 'antd';import { UserOutlined, LockOutlined } from '@ant-design/icons';import "../assets/css/login.css";class Login extends Component {	constructor ( props ) {		super( props );		this.state = {			isLogin: false,			visible: false		};		this.param = {			username: "",			password: ""		}	}	componentWillMount () {		this.getLoginStatus();	}	componentWillReceiveProps ( nextProps, nextContext ) {		this.getLoginStatus();	}	getLoginStatus () {		const { isLogin } = this.state;		const result = localStorage.getItem( "token" ) !== null;		isLogin !== result && this.setState( { isLogin: result } );	}	handleToggle ( visible ) {		this.setState( { visible } );	}	loginPost () {		const $fetch = ( url, method, body, callback, callbackType ) => {			fetch( url, {				headers: {					'Content-Type': 'application/json',				},				method: method,				body: body ? JSON.stringify( body ) : null			} )				.then( resp => {					if ( resp.ok ) {						switch ( callbackType ) {							case 'json':								return resp.json();							case 'text':								return resp.text();							case 'blob':								return resp.blob();							default:								return resp.json();						}					} else {						if ( resp.status === 404 ) {							throw new Error( 'Page not found:' + resp.url );						}						if ( resp.status === 500 ) {							throw new Error( resp.status + ' ' + resp.url );						}					}				} )				.then( data => {					if ( data.status !== -2 ) {						callback( data );					} else {						loginOut();					}				} );		};	}	handleBlur ( name, e ) {		this.param[ name ] = e.target.value;	}	render () {		const { isLogin, visible } = this.state;		return (			<div className="login-wrap">				{					isLogin ?						<Avatar icon={ <UserOutlined /> } />					:						<div>							<Button type="link" onClick={ this.handleToggle.bind( this, true ) }>登录</Button>							<Modal								title="登录"								cancelText="取消"								okText="登录"								visible={ visible }								destroyOnClose={ true }								closable={ false }								onCancel={ this.handleToggle.bind( this, false ) }								onOk={ this.loginPost.bind( this ) }							>								<Space direction="vertical" style={ { width: '80%', margin: "0 10%" } } size="middle" >									<Input										placeholder="输入账号"										prefix={ <UserOutlined className="site-form-item-icon" /> }										onBlur={ this.handleBlur.bind( this, 'username' ) }									/>									<Input.Password										placeholder="输入密码"										prefix={ <LockOutlined className="site-form-item-icon" /> }										onBlur={ this.handleBlur.bind( this, 'password' ) }									/>								</Space>							</Modal>						</div>				}			</div>		)	}}export default Login;